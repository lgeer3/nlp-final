✅ SLURM job started: Tue Apr 29 23:47:58 EDT 2025
gpuz03
Tue Apr 29 23:47:58 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:01:00.0 Off |                   On |
| N/A   28C    P0             52W /  500W |      75MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   1  NVIDIA A100-SXM4-80GB          On  |   00000000:41:00.0 Off |                   On |
| N/A   28C    P0             51W /  500W |      75MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   2  NVIDIA A100-SXM4-80GB          On  |   00000000:81:00.0 Off |                   On |
| N/A   28C    P0             51W /  500W |      75MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+
|   3  NVIDIA A100-SXM4-80GB          On  |   00000000:C1:00.0 Off |                   On |
| N/A   27C    P0             51W /  500W |      75MiB /  81920MiB |     N/A      Default |
|                                         |                        |              Enabled |
+-----------------------------------------+------------------------+----------------------+

+-----------------------------------------------------------------------------------------+
| MIG devices:                                                                            |
+------------------+----------------------------------+-----------+-----------------------+
| GPU  GI  CI  MIG |                     Memory-Usage |        Vol|        Shared         |
|      ID  ID  Dev |                       BAR1-Usage | SM     Unc| CE ENC  DEC  OFA  JPG |
|                  |                                  |        ECC|                       |
|==================+==================================+===========+=======================|
|  0    6   0   0  |              25MiB / 19968MiB    | 28      0 |  2   0    1    0    0 |
|                  |                 0MiB / 32767MiB  |           |                       |
+------------------+----------------------------------+-----------+-----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
✅ Python about to run: Tue Apr 29 23:48:00 EDT 2025
✅ Python path: /home/cs601-lgeer3/scr4-cs601-dkhasha1/cs601-lgeer3/nlp-final/env/bin/python
✅ Torch version: 2.7.0+cu126
✅ CUDA available: True
✅ importing argparse
✅ importing torch
✅ importing tokenizer
✅ importing datasets
✅ importing defaultdict
✅ importing list
✅ importing tensor
✅ importing dataloader
✅ importing torch
✅ importing torch
✅ importing tqdm
✅ importing scheduler
✅ importing evaluate
✅ importing sys
✅ importing plt
✅ importing math
✅ importing gradscaler
✅ Python started
Using device: cuda
PREPROCESSING DATA
loading tokenizer
loaded
about to load corpus
loaded corpus
⚠️ Truncating input_ids from 2099306 to 200000
⚠️ Truncating input_ids from 2290103 to 200000
MAKING MODEL
TRAINING MODEL
Traceback (most recent call last):
  File "/scratch4/cs601-dkhasha1/cs601-lgeer3/nlp-final/run_experiment.py", line 80, in <module>
    main()
  File "/scratch4/cs601-dkhasha1/cs601-lgeer3/nlp-final/run_experiment.py", line 64, in main
    train_model(
  File "/scratch4/cs601-dkhasha1/cs601-lgeer3/nlp-final/training/train.py", line 78, in train_model
    scaler = GradScaler(enabled=mixed_precision, device_type="cuda")
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: GradScaler.__init__() got an unexpected keyword argument 'device_type'
✅ Python finished: Tue Apr 29 23:54:04 EDT 2025
